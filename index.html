<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>CRUD Supabase - Nomes</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #f5f5f5;
      margin: 2rem;
    }
    h1 {
      color: #333;
    }
    form {
      margin-bottom: 1rem;
    }
    input, button {
      padding: 0.5rem;
      margin-right: 0.5rem;
    }
    ul {
      list-style-type: none;
      padding-left: 0;
    }
    li {
      background: #fff;
      margin-bottom: 0.5rem;
      padding: 0.5rem;
      display: flex;
      justify-content: space-between;
      align-items: center;
      border-radius: 4px;
    }
    .actions button {
      margin-left: 0.5rem;
    }
  </style>
</head>
<body>

<h1>CRUD com Supabase</h1>

<form id="form">
  <input type="text" id="nome" placeholder="Digite um nome" required />
  <button type="submit">Salvar</button>
</form>

<ul id="lista-nomes"></ul>

<!-- Lib oficial do Supabase -->
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js"></script>
<script>
  // üîß Configura√ß√£o do Supabase
  const SUPABASE_URL = 'https://wdioubjndxrvfwbxaile.supabase.co'; // üîÅ Substitua
  const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6IndkaW91YmpuZHhydmZ3YnhhaWxlIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDY3OTIzMjQsImV4cCI6MjA2MjM2ODMyNH0.KYyVMGjjKqc7F9iXGp5wSqZKQBsKRbIt0Li8DNeOriw'; // üîÅ Substitua
  const supabase = supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

  const form = document.getElementById('form');
  const nomeInput = document.getElementById('nome');
  const lista = document.getElementById('lista-nomes');

  let editandoId = null;

  // üîÉ Carregar nomes ao iniciar
  async function carregarNomes() {
    const { data, error } = await supabase.from('nomes').select('*').order('nome');
    if (error) {
      alert('Erro ao carregar nomes: ' + error.message);
    } else {
      lista.innerHTML = '';
      data.forEach(item => {
        const li = document.createElement('li');
        li.innerHTML = `
          <span>${item.nome}</span>
          <div class="actions">
            <button onclick="editarNome('${item.id}', '${item.nome}')">‚úèÔ∏è</button>
            <button onclick="deletarNome('${item.id}')">üóëÔ∏è</button>
          </div>
        `;
        lista.appendChild(li);
      });
    }
  }

  // üíæ Criar ou atualizar nome
  form.addEventListener('submit', async (e) => {
    e.preventDefault();
    const nome = nomeInput.value.trim();
    if (!nome) return;

    if (editandoId) {
      // Atualizar
      const { error } = await supabase.from('nomes').update({ nome }).eq('id', editandoId);
      if (error) alert('Erro ao atualizar: ' + error.message);
      editandoId = null;
    } else {
      // Criar novo
      const { error } = await supabase.from('nomes').insert([{ nome }]);
      if (error) alert('Erro ao salvar: ' + error.message);
    }

    nomeInput.value = '';
    carregarNomes();
  });

  // üßΩ Editar
  window.editarNome = (id, nome) => {
    nomeInput.value = nome;
    nomeInput.focus();
    editandoId = id;
  };

  // ‚ùå Deletar
  window.deletarNome = async (id) => {
    const { error } = await supabase.from('nomes').delete().eq('id', id);
    if (error) alert('Erro ao deletar: ' + error.message);
    carregarNomes();
  };

  // Iniciar carregamento
  carregarNomes();
</script>
</body>
</html>
